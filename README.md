arcin
=====
This repository contains firmware code for the arcin v1.1, a custom game controller board with support for 11 buttons, 2 analog or quadrature encoders, 2 always-on LCDs, and WS2812B LED lighting via the B9 connector.

The `svre9` branch in this repository contains modifications to improve user experience when using this board with DJ Dao SVRE9 or SVSE5 game controllers outfitted with arcade-style encoders.

The `sv3c-kb` branch in this repository is based off of the `svre9` branch, with additional modifications to present the device as a keyboard instead of a game controller. This makes the device compatible with SOUND VOLTEX III e-AMUSEMENT CLOUD Trial 1.1, which only supports keyboard input: http://p.eagate.573.jp/game/eacsdvx/iii/p/common/a_test/atest_top.html

The original codebase by zyp is available at: http://cgit.jvnv.net/arcin/log/?h=conf (the `svre9` branch is based on the current HEAD of the `conf` branch, `1cb55ca06ecbc3666d3bf66a583a768f69bf9278`)

Setup
-----
1. Grab the ARM toolchain: https://launchpad.net/gcc-arm-embedded/+download
2. You will need SCons to build the image: http://scons.org/pages/download.html
3. `git submodule init`: this will pull the external `laks` submodule, which contains headers for the hardware used by the arcin.
4. Supplementary scripts will require Python (2.7) as well as the following Python modules:
- pyhidapi (https://github.com/NF6X/pyhidapi)
- pyelftools (https://pypi.python.org/pypi/pyelftools/)
5. You may also find the following libraries useful (package names taken from Ubuntu's repositories):
- libhidapi-libusb0
- libusb-dev
- lib-usb-1.0-0-dev

Building and Testing
--------------------
1. `scons`
2. `./hidflash.py arcin.elf`

See `simpletest.py` for an example test script to monitor HID reports generated by an arcin controller.

Packaging
---------
After building an image using `scons`, use the Python script in the arcin-utils directory to build a custom hidloader EXE with your new firmware image embedded into it. This EXE can be given to users to easily flash their device.

1. `./hidloader_append.py arcin.elf hidloader_v2.exe arcin_flash_custom.exe`

Pre-Built Images
----------------
The `bin/` directory in this repository contains already built and packaged firmwares. The `.elf` files can be flashed onto a device using the `hidflash.py` script. Standalone `.exe` files are also provided.

- `arcin-svre9-alpha`: A modification of arcin firmware suited for SVRE9 or SVSE5 controllers, which aims to reduce noise from analog inputs.
- `arcin-svre9-alpha2`: A later modification of the above firmware, which further reduces noise from analog inputs at the cost of slightly lowered sensitivity.
- `arcin-sdvx-[ac|copal]`: Firmware for use with SVRE9 or SVSE5 controllers using either AC or Copal encoders, presented as a gamepad. WS2812B lighting available via B9. (`arcin-sdvx-ac` is effectively the same as `arcin-svre9-alpha2`)
- `arcin-sdvx-[ac|copal]-kb`: Same as the above, except presented as a keyboard.
- `arcin-sdvx-[ac|copal]-nolight`: Same as `arcin-sdvx-[ac|copal]`, except with WS2812B lighting disabled. This means B9 can be used as a button.
- `arcin-sdvx-[ac|copal]-kb-nolight`: Combination of the two firmwares above. No WS2812B lighting, presented as a keyboard.